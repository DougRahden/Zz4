# === Cell 7: Save entity resolution results to CSV with latest affiliation fields ===

import pandas as pd

output_path = "D:/aa030/output/entity_resolution_output.csv"

columns = [
    "input_name",
    "matched_name",
    "scopus_id",
    "eid",
    "paper_title",
    "affiliation_latest",
    "affiliation_city_latest",
    "affiliation_country_latest",
    "publication_date"
]

pd.DataFrame(entity_resolution_output, columns=columns).to_csv(output_path, index=False)

print(f"[SAVED] {output_path} â†’ {len(entity_resolution_output)} rows")
